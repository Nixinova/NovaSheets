function parseNovaSheets(){let e=document.querySelectorAll('link[rel="novasheet"]'),t=[];for(let n of e)t.push(n.href);let n=[];for(let e of t)try{let t=new XMLHttpRequest;t.open("GET",e,!1),t.send();let o=t.responseText;n.push(o.toString())}catch(t){console.error(`NovaSheets parsing failed: File "${e}" cannot be accessed.`)}let o=document.querySelectorAll('template[type="novasheet"]');for(let e of o)n.push(e.innerHTML);for(let e of n){let t=e.split("\n"),n=[],o={};for(let e in t)t[e]=t[e].replace(/[\r\n]/g,"").replace(/^(.*?)\s?\/\/.+$/,"$1"),t[e].match(/\s*---\s*/)&&(t[e]="---"),t[e].match(/^\s*@var\s/)&&n.push({line:Number(e),name:t[e].replace(/^\s*@var\s/,"")});const l=t.indexOf("---"),r=t.slice(l+1).join("\n");for(let e in n){let r=n[e].line+1,s=n[e].name,a=n[e+1]&&n[e+1].line;for(isNaN(a)&&(a=l);r<a&&!t[r].match(/\s*@var\s/);)o[s]||(o[s]=""),o[s]+=t[r],r++}let s=0,a=r;const c=50;for(;a.indexOf("$(")>-1&&s++<c;)for(let e in n)a=a.split("$("+n[e].name+")").join(o[n[e].name]||"");a=a.replace(/; *;/g,";").replace(/ +/g," ");let i=document.createElement("style");i.dataset.hash=a.hashCode(),i.innerHTML="\n"+a+"\n",(document.head||document.body).appendChild(i)}}String.prototype.hashCode=function(){let e=0;for(let t=0;t<this.length;t++)e=(e<<5)-e+this.charCodeAt(t);return Math.abs(e).toString(16)},document.addEventListener("DOMContentLoaded",function(){parseNovaSheets()});