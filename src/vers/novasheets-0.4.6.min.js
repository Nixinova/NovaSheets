function nse(e,t){return t?"func"==e?nse(`Unknown argument "${t[1]}" in function "${t[0]}" ${t[2]}`.trim()+"."):void 0:console.error("<NovaSheets> Parsing failed: "+e)}function parseNovaSheets(){let ex,il;try{ex=document.querySelectorAll('link[rel="novasheet" i], link[rel="novasheets" i]'),il=document.querySelectorAll('[type="novasheet" i], [type="novasheets" i]')}catch(e){ex=document.querySelectorAll('link[rel="novasheet"], link[rel="novasheets"]'),il=document.querySelectorAll('[type="novasheet"], [type="novasheets"]')}let fn={full:[],rel:[]},sources=[];for(let e of ex)fn.full.push(e.href),fn.rel.push(e.getAttribute("href"));let sc=[];for(let e in fn.full)try{let t=new XMLHttpRequest;t.open("GET",fn.full[e],!1),t.send();let r=t.responseText;sc.push(r.toString()),sources.push(fn.rel[e])}catch(t){nse(`File "${fn.rel[e]}" cannot be accessed.`)}for(let e of il)sc.push(e.innerHTML),sources.push("il");window.randomHash=window.randomHash||Math.random().toString().hashCode(6);for(let s in sc){sc[s]=sc[s].replace(/^(.*?)\/\/.*$/gm,"$1").replace(/^@var.+?=.*$/gm,"$& @endvar").replace(/@(var|const|endvar)/g,"\n@$1");let ln=sc[s].split("\n"),cso="";for(let e in ln)ln[e]=ln[e].replace(/[\r\n]/g," ").trim(),cso+=" "+ln[e];cso=cso.replace(/\s*@(var|const)[\s\S]*?((?=\s*@(var|const))|@endvar)/gm," ");let cv=[],lv=[],MAX_RECURSION=50,MAX_ARGUMENTS=10;for(let e in ln)if(ln[e].match(/^\s*@var\s/)){let t=ln[e].replace(/^\s*@var\s/,"").split("="),r=ln.slice(e),s;for(let e in r)if(r[e].match(/^\s*@endvar\s*$|^\s*@var\s/)&&0!=e){s=e;break}let n=t[0].trim(),a=(t[1]||"")+r.slice(1,s).join(" ");cv.push({line:Number(e),ending:Number(s),cn:a.trim(),name:n.split("|")[0].trim(),params:n.split("|").slice(1)})}else ln[e].match(/^\s*@const\s*MAX[_]RECURSION\s/)?MAX_RECURSION=Number(ln[e].split("MAX_RECURSION")[1]):ln[e].match(/^\s*@const\s*MAX[_]ARGUMENTS\s/)&&(MAX_ARGUMENTS=Number(ln[e].split("MAX_ARGUMENTS")[1]));for(let e in cv)for(let t in cv[e].params){let r=cv[e].params[t].trim(),s=[t,cv[e].name,window.randomHash,r].join("~"),n=`$[${r}]`,a=`$(${s})`;cv[e].cn=cv[e].cn.split(n).join(a),lv.push(s)}let loop=0;for(;(cso.indexOf("$(")>-1||loop<2)&&loop++<MAX_RECURSION;){for(let e in cv){let t=cv[e].name.eR(),r=e=>"\\s*(?:\\|\\s*([^"+(e||"")+"|$()]+)\\s*)?",s=r().repeat(MAX_ARGUMENTS),n=`\\$\\(\\s*(${t})\\s*${s}\\s*\\)`,a=`\\$\\(\\s*${t}${r("=").repeat(MAX_ARGUMENTS)}\\s*\\)`,u="$("+t;for(let e=1;e<=MAX_ARGUMENTS;e++)u+="|"+e+"=$"+e;cso=cso.replace(RegExp(a),u+")");let l=cso.match(RegExp(n));if(!l)continue;let c="\\$\\(\\s*"+t+"[^$()]*?\\)";cso=cso.replace(RegExp(c),cv[e].cn);for(let e=0;e<l.length;e++){if(e<2||!l[e])continue;let[t,r]=l[e].split("=");for(let e of lv){let s="\\$\\(\\s*"+e.eR()+"\\)",n=e.split("~").splice(3).join("~");n===t.trim()&&(cso=cso.replace(RegExp(s,"g"),r.trim()))}}}const nf=(e,t,r)=>(Array.isArray(t)||(t=Array(r||MAX_ARGUMENTS).fill(t||"[^|)]*?")),RegExp(`\\$\\(\\s*${e}\\s*(?:\\|\\s*(${t.join("))?\\s*(?:\\|\\s*(")}))?\\s*\\)`,"g")),nm="[0-9]*[.]?[0-9]+",bnm="(?:0x|0b|0o)?"+nm,bnr=`\\(${bnm}\\)|${bnm}`,nur=`([+-]?${bnr})(m|cm|mm|ft|in|em|rem|en|ex|px|pt|pc)?`,mr=e=>`(${bnr})\\s*${e.eR()}\\s*(${bnr})`,umr=e=>`${nur}\\s*${e.eR()}\\s*${nur}`,mrb=e=>"\\(\\s*"+mr(e)+"\\s*\\)",pm=(ops,b)=>{for(let op of ops){Array.isArray(op)||(op=[op,op]),cso=cso.replace(RegExp(bnm,"g"),e=>Number(e)).replace(RegExp(`(?<!(?:#|0x)[0-9a-f.]*)(${nm})[Ee]([+-]?${nm})`),(e,t,r)=>{return(Number(t)*Math.pow(10,Number(r))).toFixed(20).replace(/\.?0+$/,"")}).replace(/(?:\+|--)+([.0-9]+)/,"+$1").replace(/(?:\+-|-\+)+(?:\++)?([.0-9]+)/,"-$1").replace(RegExp(umr(op[0])),(_,n1,u1,n2,u2)=>{n1=Number(n1),n2=Number(n2);let O=(n1,n2)=>eval(n1+op[0]+n2);if(!u1&&!u2)return _;switch(u1+","+u2){case"m,cm":return O(100*n1,n2)+u2;case"cm,m":return O(n1/100,n2)+u2;case"m,mm":return O(1e3*n1,n2)+u2;case"mm,m":return O(n1/1e3,n2)+u2;case"cm,mm":return O(10*n1,n2)+u2;case"mm,cm":return O(n1/10,n2)+u2;case"m,in":return O(39.3701*n1,n2)+u2;case"in,m":return O(n1/39.3701,n2)+u2;case"cm,in":return O(.393701*n1,n2)+u2;case"in,cm":return O(n1/.393701,n2)+u2;case"mm,in":return O(.0393701*n1,n2)+u2;case"in,mm":return O(n1/.393701,n2)+u2;case"m,ft":return O(3.28084*n1,n2)+u2;case"ft,m":return O(n1/3.28084,n2)+u2;case"cm,ft":return O(.0328084*n1,n2)+u2;case"ft,cm":return O(n1/.0328084,n2)+u2;case"mm,ft":return O(.00328084*n1,n2)+u2;case"ft,mm":return O(n1/.00328084,n2)+u2;default:return O(n1,n2)+(u2||u1)}});let rg=b?mrb(op[0]):mr(op[0]),nums=cso.match(RegExp(rg));if(!nums)continue;let result=eval(`Number(${nums[1]}) ${op[1]} Number(${nums[2]})`);cso=cso.replace(RegExp(rg),result)}};for(let e=0;e<MAX_RECURSION/10;e++){const e=["**",["^","**"],"/","*","+","-",["--","- -"]];pm(e,!0),pm(e,!1)}cso=cso.replace(/\$\(@pi\)/g,Math.PI).replace(/\$\(@e\)/g,Math.E).replace(nf("@mod",nm,2),(e,t,r)=>t%r).replace(nf("@sin",nm,1),(e,t)=>Math.sin(t)).replace(nf("@asin",nm,1),(e,t)=>Math.asin(t)).replace(nf("@cos",nm,1),(e,t)=>Math.cos(t)).replace(nf("@acos",nm,1),(e,t)=>Math.acos(t)).replace(nf("@tan",nm,1),(e,t)=>Math.tan(t)).replace(nf("@atan",nm,1),(e,t)=>Math.atan(t)).replace(nf("@abs",nm,1),(e,t)=>Math.abs(t)).replace(nf("@floor",nm,1),(e,t)=>Math.floor(t)).replace(nf("@ceil",nm,1),(e,t)=>Math.ceil(t)).replace(nf("@percent",nm,1),(e,t)=>100*Number(t)+"%").replace(nf("@log",nm,2),(e,t,r)=>Math.log(r)/(t?Math.log(t):1)).replace(nf("@root",nm,2),(e,t,r)=>Math.pow(r,1/t)).replace(nf("@round",nm,2),(e,t,r)=>Math.round((Number(t)+Number.EPSILON)*Math.pow(10,r||0))/Math.pow(10,r||0)).replace(nf("@min",nm),(e,...t)=>{let r=[];for(let s of t)s&&!s.toString().includes(e)&&r.push(s);return Math.min(...r)}).replace(nf("@max",nm),(e,...t)=>{let r=[];for(let s of t)s&&!s.toString().includes(e)&&r.push(s);return Math.max(...r)}).replace(nf("@clamp",nm,3),(e,t,r,s)=>(s<r&&([r,s]=[s.trim(),r.trim()]),t<=r?r:t>=s?s:t)).replace(nf("@degrees","("+nm+")\\s*(deg|rad|grad)?",1),(e,t,r,s)=>"grad"===s?10*r/9:r/Math.PI*180).replace(nf("@radians","("+nm+")\\s*(deg|rad|grad)?",1),(e,t,r,s)=>"grad"===s?r*Math.PI/200:r*Math.PI/180).replace(nf("@gradians","("+nm+")\\s*(deg|rad|grad)?",1),(e,t,r,s)=>"rad"===s?r/Math.PI*200:.9*r),cso=cso.replace(nf("@encode"),(e,t)=>encodeURIComponent(t)).replace(nf("@length"),(e,t)=>t.trim().length).replace(nf("@replace"),(e,t,r,s)=>{if(r.startsWith("/")){let e=r.replace(/\/(.+?)\/[gimusy]*/,"$1").trim(),t=r.replace(/\/.+?\/([gimusy]*)/,"$1").trim(" ")||"s";r=RegExp(e,t)}return t.trim().replace(RegExp((r||" ").eR(),"g"),s.trim())});const car=`(?:rgba?|hsla?)\\(\\s*\\d{1,3}\\s*,${`\\s*,\\s*${nm}%?\\s*`.repeat(3)}(?:\\s*,\\s*${nm})?\\s*\\)|#[0-9a-f]{3,8}`;cso=cso.replace(nf("@color",["\\w+",nm,nm+"%?",nm+"%?",nm+"%?"],4),(e,t,r,s,n,a)=>{if("hash"===t||t.startsWith("hex")||"#"===t){if(!r)return"#000";r.startsWith("rgb")&&([r,s,n,a]=r.replace(/rgba?\(|\)/g,"").split(","));const e=e=>(Number(e)||0).toString(16).padStart(2,"0");return"#"+e(r)+e(s)+e(n)+(e(a)<1?"":e(a))}return["rgb","rgba"].includes(t)?(s.includes("%")&&(s=Number(s.replace(/%/,""))/100*256-1),n.includes("%")&&(n=Number(n.replace(/%/,""))/100*256-1),`${t}(${Number(r)}, ${Number(s)}, ${Number(n)}${a&&"rgba"===t?","+Number(a.replace(/%/g,"")):""}${a.includes("%")?"%":""})`):["hsl","hsla"].includes(t)?`${t}(${Number(r)}, ${Number(s.replace(/%/,""))}%, ${Number(n.replace(/%/,""))}%${a&&"hsla"===t?", "+Number(a.replace(/%/g,"")):""}${a.includes("%")?"%":""})`:void 0}).replace(nf("@color",["\\w+",car]),(e,t,r)=>{if(r.startsWith("#")){let e;r.length-1==3?e=[r[1].repeat(2),r[2].repeat(2),r[3].repeat(2)]:r.length-1==4?e=[r[1].repeat(2),r[2].repeat(2),r[3].repeat(2),r[4].repeat(2)]:[5,6].includes(r.length-1)?e=[r[1]+r[2],r[3]+r[4],r[5]+(r[6]||"0")]:[7,8].includes(r.length-1)&&(e=[r[1]+r[2],r[3]+r[4],r[5]+r[6],r[7]+(r[8]||"0")]),r=parseInt(e[0],16),b=parseInt(e[1],16).toString()||0,c=parseInt(e[2],16).toString()||0,d=parseInt(e[3],16)||0}else parts=r.replace(/^\s*...a?\s*/,"").replace(/[()]/g,"").split(","),[r,b,c,d]=parts;return`${t}(${r}, ${b}, ${c}${d?", "+d:""})`}).replace(nf("@colorpart",["\\w+",car]),(e,t,r)=>{t=t.trim().toLowerCase();let s=[];const n=(e,t)=>Number("0x"+e.substr(t,2)).toString();if((r=r.trim().toLowerCase()).startsWith("#")){let e=r.replace("#","");3===e.length&&(e=e[0].repeat(2)+e[1].repeat(2)+e[2].repeat(2)+"00"),4===e.length&&(e=e[0].repeat(2)+e[1].repeat(2)+e[2].repeat(2)+e[3].repeat(2)),6===e.length&&(e+="00"),s=[n(e,0),n(e,2),n(e,4),n(e,6)]}else s=r.replace(/^\s*...a?\s*/,"").replace(/[()]/g,"").split(",");return r.startsWith("#")||r.startsWith("rgb")?t.startsWith("r")?s[0]:t.startsWith("g")?s[1]:t.startsWith("b")?s[2]:t.startsWith("a")?s[3]:(nse("func",["colorpart",t,"of color type rgb/rgba/#"]),r):r.startsWith("hsl")?t.startsWith("h")?s[0]:t.startsWith("s")?s[1]:t.startsWith("l")?s[2]:t.startsWith("a")?s[3]:(nse("func",["colorpart",t,"of color type hsl/hsla"]),r):(nse("func",["colorpart",t,"of unknown color type"]),r)});const plg=arg=>{for(let e=0;e<MAX_ARGUMENTS/10;e++)arg=arg.trim().replace(/(?:'(.+?)'|"(.+?)")+/,"$1$2").replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/\bor\b/gi,"||").replace(/\band\b/gi,"&&").replace(/\bnot\b/gi,"!").replace(/(.+?)\bnor\b(.+)?/gi,"!($1) && !($2)").replace(/(.+?)\bnand\b(.+)?/gi,"!($1) || !($2)").replace(/(.+?)\bxor\b(.+)?/gi,"($1 && !($2)) || (!($1) && $2)").replace(/(.+?)\bxnor\b(.+)?/gi,"$1 == $2").replace(/(?!=)(!?)=(==)?(?!=)/g,"$1$2==");return arg.match(/(<|<=|>|>=|==|!=|&|\||!)/)&&(arg=eval(arg)),["false","undefined","null","NaN",""].includes(arg)&&(arg=!1),arg},lrg=e=>RegExp(`([+-]?${bnr})\\s*(?:${e})\\s*([+-]?${bnr})`);cso=cso.replace(nf("@bitwise"),(_,a)=>{a=a.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<");for(let i=0;i<MAX_ARGUMENTS/10;i++)a=a.replace(RegExp(`(?:~|!|not)\\s*([+-]?${bnr})`),(_,a)=>eval("~"+Number(a))).replace(lrg("or|\\|"),(_,a,b)=>eval(`(${Number(a)}) | (${Number(b)})`)).replace(lrg("nor"),(_,a,b)=>eval(`~ (${Number(a)}) | (${Number(b)})`)).replace(lrg("and|&"),(_,a,b)=>eval(`(${Number(a)}) & (${Number(b)})`)).replace(lrg("nand"),(_,a,b)=>eval(`~ (${Number(a)}) & (${Number(b)})`)).replace(lrg("xor"),(_,a,b)=>eval(`(${Number(a)}) ^ (${Number(b)})`)).replace(lrg("xnor"),(_,a,b)=>eval(`~ (${Number(a)}) ^ (${Number(b)})`));return a}).replace(nf("@boolean"),(e,t)=>plg(t)).replace(nf("@if"),(e,t,r,s)=>plg(t)?r:s||"")}if(cso=cso.replace(/\$\(.+?\)/g,"").replace(/@endvar/g,"").replace(/(\s*;)+/g,";").replace(/\s+/g," ").replace(/} *(?!$)/g,"}\n").replace(/\.?0{8,}\d/,"").replace(/(\d)(9{8,})\d?\b/g,(e,t)=>Number(t)+1),document.querySelectorAll(`[data-hash="${cso.hashCode()}"]`).length)break;let se=document.createElement("style");se.innerHTML="\n"+cso+"\n",se.dataset.hash=cso.hashCode(),se.dataset.source=sources[s],(document.head||document.body).appendChild(se)}}String.prototype.hashCode=function(e){let t=0;for(let e=0;e<this.length;e++)t=(t<<5)-t+this.charCodeAt(e);return Math.abs(t).toString(16).substring(0,e||8).padStart(e,"0")},String.prototype.trim=function(e){return this.replace(/^\s*(.+?)\s*$/,"$1").replace(/\s+/g,e?"":" ")},String.prototype.eR=function(){return this.replace(/[.*+?^/${}()|[\]\\]/g,"\\$&")},document.addEventListener("DOMContentLoaded",parseNovaSheets());