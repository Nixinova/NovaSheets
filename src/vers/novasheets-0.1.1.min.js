function parseNovaSheets(){let e=document.querySelectorAll('link[rel="novasheet"]'),t=[];for(let n of e)t.push(n.href);let n=[];for(let e of t)try{let t=new XMLHttpRequest;t.open("GET",e,!1),t.send();let o=t.responseText;n.push(o.toString())}catch(t){console.error(`NovaSheets parsing failed: File "${e}" cannot be accessed.`)}let o=document.querySelectorAll('template[type="novasheet"]');for(let e of o)n.push(e.innerHTML);for(let e of n){let t=e.split("\n"),n=[],o={};for(let e in t)t[e]=t[e].replace(/^(.*?) \/\/.+$/,"$1"),t[e].match(/ *--- */)&&(t[e]="---"),t[e].match(/ *@var /)&&n.push({line:Number(e),name:t[e].replace(/ *@var (.+?)(?: \/\/.*)?$/,"$1")});const l=t.indexOf("---"),r=t.slice(l+1).join("\n");for(let e in n){let r=n[e].line+1,a=n[e].name,s=n[e+1]&&n[e+1].line;for(isNaN(s)&&(s=l);r<s&&!t[r].match(/ *@var /);)o[a]||(o[a]=""),o[a]+=t[r],r++}let a=r;for(;a.indexOf("$(")>-1;)for(let e in n)a=a.split("$("+n[e].name+")").join(o[n[e].name]||"");a=a.replace(/; *;/g,";").replace(/ +/g," ");let s=document.createElement("style");s.dataset.hash=a.hashCode(),s.innerHTML="\n"+a+"\n",(document.head||document.body).appendChild(s)}}String.prototype.hashCode=function(){let e=0;for(let t=0;t<this.length;t++)e=(e<<5)-e+this.charCodeAt(t);return Math.abs(e).toString(16)},document.addEventListener("DOMContentLoaded",function(){parseNovaSheets()});